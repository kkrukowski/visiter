<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Umów na wizytę | Visiter</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="stylesheet" href="/styles/styles.css" />
    <link rel="stylesheet" href="/styles/main.css" />
    <link rel="stylesheet" href="/styles/visit.css" />
    <link rel="stylesheet" href="/styles/normalize.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
  </head>
  <body>
    <!-- Nav -->
    <nav class="nav">
      <div class="nav__wrapper">
        <a href="/" class="nav__img--link"
          ><img
            src="/assets/imgs/visiter-inline.png"
            alt="Visiter"
            title="Visiter"
            class="nav--img"
        /></a>
        <section class="menu__list">
          <li class="menu__list--item">
            <a href="/" class="item--link">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="item--icon"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"
                />
              </svg>

              <p class="list__item--name">Strona Główna</p>
            </a>
          </li>
          <li class="menu__list--item">
            <a href="/profile/<%= user._id %>" class="item--link"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="item--icon"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
                />
              </svg>
              <p class="list__item--name">Mój profil</p>
            </a>
          </li>
          <li class="menu__list--item">
            <a href="/business/search" class="item--link"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="item--icon"
              >
                <path
                  d="M8.25 10.875a2.625 2.625 0 115.25 0 2.625 2.625 0 01-5.25 0z"
                />
                <path
                  fill-rule="evenodd"
                  d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.125 4.5a4.125 4.125 0 102.338 7.524l2.007 2.006a.75.75 0 101.06-1.06l-2.006-2.007a4.125 4.125 0 00-3.399-6.463z"
                  clip-rule="evenodd"
                />
              </svg>

              <p class="list__item--name">Szukaj</p>
            </a>
          </li>
          <li class="menu__list--item">
            <a href="/visits" class="item--link"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="item--icon"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"
                />
              </svg>
              <p class="list__item--name">Moje wizyty</p>
            </a>
          </li>
          <li class="menu__list--item">
            <a href="/chat" class="item--link"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="item--icon"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.625 9.75a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 01.778-.332 48.294 48.294 0 005.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"
                />
              </svg>
              <p class="list__item--name">Wiadomości</p>
            </a>
          </li>
        </section>
      </div>
    </nav>
    <!-- Main block -->
    <main class="main">
      <form method="POST" class="visit__booking--form">
        <section class="employees--section">
          <h3>Pracownicy</h3>
          <div class="employees--list">
            <% workersDayAvailabilityInfo.forEach((info) => { %> <% if
            (info.worker.id === selectedWorker) { %>
            <a
              href="/visits/book/<%= service.id %>/worker/<%= info.worker.id %>/day/<%= date.day %>/month/<%= date.month %>/year/<%= date.year %>"
              class="employeer--btn selected"
            >
              <img src="/assets/imgs/profile.webp" class="employeer--avatar" />
              <span class="employeer--name"><%= info.worker.name %></span>
            </a>
            <% } else { %> <% if (info.isAvailable == true) { %>
            <a
              href="/visits/book/<%= service.id %>/worker/<%= info.worker.id %>/day/<%= date.day %>/month/<%= date.month %>/year/<%= date.year %>"
              class="employeer--btn"
            >
              <img src="/assets/imgs/profile.webp" class="employeer--avatar" />
              <span class="employeer--name"><%= info.worker.name %></span>
            </a>
            <% } else { %>
            <div class="employeer--btn unavailable">
              <img src="/assets/imgs/profile.webp" class="employeer--avatar" />
              <span class="employeer--name"><%= info.worker.name %></span>
            </div>
            <% } %> <% } %> <% }) %>
          </div>
        </section>
        <section class="main--days">
          <div class="calendar--container">
            <h3>Dni</h3>
            <% const daysArray = ["Pon", "Wt", "Śr", "Czw", "Pt", "Sob", "Nd"]
            %>
            <table class="calendar--table">
              <tr>
                <% daysArray.forEach(function (day){ %>
                <th><span><%= day %></span></th>
                <% }) %>
              </tr>
              <% if(calendarInfo) { %> <% calendarInfo.forEach(function
              (weekInfo) { %>
              <tr>
                <% weekInfo.forEach(function (dateInfo) { %>
                <td>
                  <% if(allDatesAvailabilityInfo) { %> <% if
                  (dateInfo.isAvailable) { %> <% if(dateInfo.day == date.day) {
                  %>
                  <a
                    href="/visits/book/<%= service.id %>/day/<%= dateInfo.day %>/month/<%= date.month %>/year/<%= date.year %>/"
                    class="day--btn selected"
                    ><%= dateInfo.day %></a
                  >
                  <% } else { %>
                  <a
                    href="/visits/book/<%= service.id %>/day/<%= dateInfo.day %>/month/<%= date.month %>/year/<%= date.year %>/"
                    class="day--btn"
                    ><%= dateInfo.day %></a
                  >
                  <% } %> <% } else { %>
                  <span class="day--btn unavailable"><%= dateInfo.day %></span>
                  <% } %> <% } %>

                  <!-- Available dates for specific worker -->
                  <% if(workerDatesAvailabilityInfo) { %> <% if
                  (dateInfo.isAvailable) { %> <% if(dateInfo.day == date.day) {
                  %>
                  <a
                    href="/visits/book/<%= service.id %>/worker/<%= selectedWorker %>/day/<%= dateInfo.day %>/month/<%= date.month %>/year/<%= date.year %>/"
                    class="day--btn selected"
                    ><%= dateInfo.day %></a
                  >
                  <% } else { %>
                  <a
                    href="/visits/book/<%= service.id %>/worker/<%= selectedWorker %>/day/<%= dateInfo.day %>/month/<%= date.month %>/year/<%= date.year %>/"
                    class="day--btn"
                    ><%= dateInfo.day %></a
                  >
                  <% } %> <% } else { %>
                  <span class="day--btn unavailable"><%= dateInfo.day %></span>
                  <% } %> <% } %>
                </td>
                <% }) %>
              </tr>
              <% }) %> <% } %>
            </table>
          </div>
        </section>
        <section class="main--hours">
          <h3>Dostępne godziny</h3>
          <div class="hours--container">
            <div class="hours--list">
              <% if(availableHours) { %> <% availableHours.forEach(function
              (availableHour) { %> <% if(availableHour[0] == date.hour &&
              availableHour[1] == date.minute) { %>
              <a
                href="/visits/book/<%= service.id %>/worker/<%= selectedWorker %>/day/<%= date.day %>/month/<%= date.month %>/year/<%= date.year %>/hour/<%= availableHour[0] %>/minute/<%= availableHour[1] %>"
                class="hour--btn selected"
                ><%= availableHour[0] %>:<%= availableHour[1] %></a
              >
              <% } else { %>
              <a
                href="/visits/book/<%= service.id %>/worker/<%= selectedWorker %>/day/<%= date.day %>/month/<%= date.month %>/year/<%= date.year %>/hour/<%= availableHour[0] %>/minute/<%= availableHour[1] %>"
                class="hour--btn"
                ><%= availableHour[0] %>:<%= availableHour[1] %></a
              >
              <% } %> <% }) %> <% } %> <% if(availableHours.length == 0) { %>
              <p class="hours__null--text">
                Brak dostepnych godzin w wybranym terminie
              </p>
              <% } %>
            </div>
          </div>
        </section>
        <button class="submit--btn">Potwierdź</button>
      </form>
    </main>
  </body>
  <script src="/js/script.js"></script>
  <script src="/js/visitBooking.js"></script>
</html>
