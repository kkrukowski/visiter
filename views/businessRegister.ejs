<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rejestracja firmy | Visiter</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="stylesheet" href="/styles/styles.css" />
    <link rel="stylesheet" href="/styles/normalize.css" />
    <link rel="stylesheet" href="/styles/login.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
  </head>
  <body>
    <!-- Main block -->
    <div class="login--container">
      <div class="logo--container">
        <img
          src="/assets/imgs/visiter-inline.png"
          alt="Visiter"
          title="Visiter"
          class="logo--img"
        />
      </div>
      <h1 class="login--heading">REJESTRACJA FIRMY</h1>
      <form class="login--form" action="/business/register" method="POST">
        <input
          class="login--input"
          type="text"
          name="name"
          placeholder="Nazwa firmy"
          required
        />
        <input
          class="login--input"
          type="text"
          name="description"
          placeholder="Opis firmy"
          required
        />
        <input
          class="login--input"
          type="text"
          name="address"
          placeholder="Adres firmy"
          required
        />
        <input
          class="login--input"
          type="text"
          name="phone"
          placeholder="Telefon"
          required
        />
        <div style="color:grey;" contentEditable=false id="selectedOptions" class="tags" data-text="Tagi" onclick="showOptions()"></div>
        <select id="listbox" name="listbox" style="display: none;" size="4" multiple>
        </select>
        <button class="login--btn">Zarejestruj firmę</button>
      </form>
    </div>
    <% if(message){%>
    <div class="error--popup">
      <p class="error--message"><%= message %></p>
    </div>
    <% }%>
  </body>
  <script src="../js/script.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script>
    var listBox = document.getElementById("listbox");
    var selectedOptions = document.getElementById("selectedOptions");
    var spans = document.getElementsByTagName("span");
    var listOfTags = ['Fryzjerstwo', 'Sprzątanie', 'Kurs', 'Nauka', 'Turystyka', 'Pomoc'].sort();
    
    for(var i = 0; i < listOfTags.length; i++){
      console.log("heheh")
      var element = document.createElement("option");
      element.textContent = listOfTags[i];
      element.setAttribute("value", listOfTags[i]);

      listBox.appendChild(element);
    }

    $('div').on('click', 'span', function() {
      var spanValue = $(this).attr("value");
      var tagToDelete = selectedOptions.querySelector(`tag[value='${spanValue}']`);
      selectedOptions.removeChild(tagToDelete);

      var option = document.createElement("option");
      option.setAttribute("value", spanValue);
      option.textContent = spanValue;
      listBox.appendChild(option)
    });

    function showOptions(){
      listBox.style.display = "block";
      selectedOptions.style.borderRadius = "20px 20px 0px 0px";
      selectedOptions.style.marginBottom = "0px";
    }



    listBox.addEventListener("click", function() {
      var option = listBox.options[listBox.selectedIndex];
      if (option) {
        var value = option.value;
        var text = option.text;
        listBox.removeChild(option);
        var tag = document.createElement("tag");
        tag.setAttribute("value", text);
        var close = document.createElement("span")
        close.setAttribute("value", text);
        var p = document.createElement("p")
        p.textContent = text;
        close.textContent = "x";
        tag.appendChild(p);
        tag.appendChild(close);
        selectedOptions.appendChild(tag);
        spans = document.getElementsByTagName("span");
      }
    });

    
    window.onclick = function(event) {
      if (event.target != listBox && event.target != selectedOptions) {
        listBox.style.display = "none";
        selectedOptions.style.borderRadius = "20px";
        selectedOptions.style.marginBottom = "10px";
      }
    }

  </script>
</html>
